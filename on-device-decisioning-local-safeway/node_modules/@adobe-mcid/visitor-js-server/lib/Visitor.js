"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _visitorJsShared=require("@adobe-mcid/visitor-js-shared"),_amcvCookie=require("./amcv-cookie");function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}/*************************************************************************
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2016 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by all applicable intellectual property 
* laws, including trade secret and copyright laws.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/var CONSUMER_ID_BASE="payload:",AMCV_PREFIX="AMCV_",ORG_ID_REQUIRED="Org ID is required",CONSUMER_ID_REQUIRED="Consumer ID is required",ADOBE_MC_SDID="adobe_mc_sdid",SDID_PARAM_EXPIRY=30,throwError=function throwError(a){throw new Error(a)},normalizeOrgId=function normalizeOrgId(a){return 0>a.indexOf("@")?a+"@AdobeOrg":a};function Visitor(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:throwError(ORG_ID_REQUIRED),b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,c={},d=normalizeOrgId(a),e=function e(l){return c=Object.assign({},c,l)},f=(0,_visitorJsShared.supplementalDataIDFactory)(),g=function g(l,m){var n=new RegExp("[\\?&#]"+m+"=([^&#]*)"),o=n.exec(l);if(o&&o.length)return decodeURIComponent(o[1])},h=function h(l){// Parse '|' delimited k=v pairs into an object.
var m=l.split("|");return m.reduce(function(n,o){var p=o.split("=");return n[p[0]]=decodeURIComponent(p[1]),n},{})},i=function i(){return Math.round(new Date().getTime()/1000)},k=function(j){return function(r){var s=r||global.location.href;try{var t=g(s,j);if(t)return h(t)}catch(u){// Fail silently.
}}}(ADOBE_MC_SDID);this.getVisitorValues=function(){return b?(0,_amcvCookie.pickValues)(b,["MCMID","MCAAMB","MCAAMLH"]):{}},this.getSupplementalDataID=function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:throwError(CONSUMER_ID_REQUIRED),m=f.getID(""+CONSUMER_ID_BASE+l),n=f.getState();return e({sdid:n}),m},this.attemptToPopulateSdidFromUrl=function(l){var m=k(l),n=1000000000,o=f.getState();// expired
m&&m.TS&&(n=i()-m.TS),m&&m.SDID&&m.MCORGID===d&&n<SDID_PARAM_EXPIRY&&(o.supplementalDataIDCurrent=m.SDID,o.supplementalDataIDCurrentConsumed.SDID_URL_PARAM=!0,e({sdid:o}))},this.setCustomerIDs=function(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e({customerIDs:l})},this.getState=function(){return _defineProperty({},d,c)},this.getCookieName=function(){return AMCV_PREFIX+d}}Visitor.AuthState=_visitorJsShared.AuthState;exports.default=Visitor;module.exports=exports["default"];